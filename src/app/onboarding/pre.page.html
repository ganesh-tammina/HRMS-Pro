<ion-header [translucent]="true">
  <app-header></app-header>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <div class="card-grid">
    <div class="card-tile" (click)="openCard('personal')">
      <h3>Personal Information</h3>
    </div>
    <div class="card-tile" (click)="openSalaryModal()">
      <h3>Salary Information</h3>
    </div>
    <div class="card-tile" (click)="openCard('Previous_Company')">
      <h3>Previous Company Details</h3>
    </div>
    <div class="card-tile" (click)="openCard('Policy')">
      <h3>Policy Acknowledgment</h3>
    </div>
  </div>

  <form [formGroup]="personalForm">
    <!-- Personal Details -->
    <div formGroupName="personalDetails" class="card" *ngIf="selectedCard === 'personal'">
      <h2>Personal Information</h2>

      <ion-item>
        <ion-input placeholder="Full Name" formControlName="fullName"></ion-input>
      </ion-item>

      <ion-item>
        <ion-input type="date" formControlName="dob"></ion-input>
      </ion-item>

      <ion-item>
        <ion-select formControlName="gender" placeholder="Gender">
          <ion-select-option value="male">Male</ion-select-option>
          <ion-select-option value="female">Female</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-input placeholder="Phone Number" formControlName="phone" type="tel"></ion-input>
      </ion-item>

      <ion-item>
        <ion-input placeholder="Email Address" formControlName="email" type="email"></ion-input>
      </ion-item>

      <div class="btn-group">
        <ion-button type="button" (click)="nextFromPersonal()">Next</ion-button>
        <ion-button color="medium" type="button" (click)="onCancel()">Cancel</ion-button>
      </div>
    </div>

    <!-- Previous Company Details -->
    <div formGroupName="previousCompany" class="card" *ngIf="selectedCard === 'Previous_Company'">
      <h2>Previous Company Details</h2>

      <ion-item>
        <ion-input formControlName="CompanyName" placeholder="Company Name"></ion-input>
      </ion-item>

      <ion-item>
        <ion-input formControlName="Role" placeholder="Role"></ion-input>
      </ion-item>

      <ion-item>
        <ion-input formControlName="Reason" placeholder="Reason for Leaving"></ion-input>
      </ion-item>

      <div class="btn-group">
        <ion-button type="button" (click)="onNext('Policy')">Next</ion-button>
        <ion-button color="medium" type="button" (click)="onNext('personal')">Back</ion-button>
      </div>
    </div>

    <!-- Policy Acknowledgment -->
    <div class="card" *ngIf="selectedCard === 'Policy'">
      <h2>Policy Acknowledgment</h2>
      <p>Please read and accept the policy documents.</p>
      <ion-checkbox label-placement="end">I accept the policies</ion-checkbox>

      <ion-button color="success" type="button" (click)="onSubmit()">Submit</ion-button>
      <ion-button color="medium" type="button" (click)="onNext('Previous_Company')">Back</ion-button>
    </div>
  </form>

  <!-- Salary Modal -->
  <ion-modal [isOpen]="isSalaryModalOpen" (didDismiss)="closeSalaryModal()">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Salary Information</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeSalaryModal()">Close</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content class="ion-padding">
        <form [formGroup]="salaryForm" (ngSubmit)="saveSalary()">
             <ion-item>
            <ion-label position="floating">Gross Salary</ion-label>
            <ion-input type="number" formControlName="grossSalary"></ion-input>
          </ion-item>
          <ion-item>
            <ion-label position="floating">Basic Salary</ion-label>
            <ion-input type="number" formControlName="basicSalary"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">HRA</ion-label>
            <ion-input type="number" formControlName="hra"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">Health</ion-label>
            <ion-input type="number" formControlName="health"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">EPF Contribution (Employee)</ion-label>
            <ion-input type="number" formControlName="epfEmployee"></ion-input>
          </ion-item>

          <!-- epfEmployer is readonly and auto-filled from epfEmployee -->
          <ion-item>
            <ion-label position="floating">EPF Contribution (Employer)</ion-label>
            <ion-input type="number" formControlName="epfEmployer" readonly></ion-input>
          </ion-item>

          <ion-button expand="block" type="submit">Save</ion-button>
        </form>
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-content>
