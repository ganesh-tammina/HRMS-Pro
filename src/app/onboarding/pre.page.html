<ion-header [translucent]="true">
  <app-header></app-header>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <div class="card-grid">
    <div class="card-tile" (click)="openCard('personal')">
      <h3>Personal Information</h3>
    </div>
    <div class="card-tile" (click)="openSalaryModal()">
      <h3>Salary Information</h3>
    </div>
    <div class="card-tile" (click)="openCard('offer')">
      <h3>Offer Confirmation</h3>
    </div>
    <div class="card-tile" (click)="openCard('Policy')">
      <h3>Policy Acknowledgment</h3>
    </div>
  </div>

  <form [formGroup]="personalForm">
    <!-- Personal Details -->
    <div formGroupName="personalDetails" class="card" *ngIf="selectedCard === 'personal'">
      <h2>Personal Information</h2>

      <ion-item>
        <ion-input placeholder="Full Name" formControlName="fullName"></ion-input>
      </ion-item>

      <ion-item>
        <ion-input type="date" formControlName="dob"></ion-input>
      </ion-item>

      <ion-item>
        <ion-select formControlName="gender" placeholder="Gender">
          <ion-select-option value="male">Male</ion-select-option>
          <ion-select-option value="female">Female</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-input placeholder="Phone Number" formControlName="phone" type="tel"></ion-input>
      </ion-item>

      <ion-item>
        <ion-input placeholder="Email Address" formControlName="email" type="email"></ion-input>
      </ion-item>

      <div class="btn-group">
        <ion-button type="button" (click)="nextFromPersonal()">Next</ion-button>
        <ion-button color="medium" type="button" (click)="onCancel()">Cancel</ion-button>
      </div>
    </div>

    <!-- Offer Confirmation Card -->
    <div class="card" *ngIf="selectedCard === 'offer'">
      <h2>Offer Confirmation</h2>
      <form [formGroup]="offerForm">
        <ion-item>
          <ion-label>Offer Validity (days)</ion-label>
          <ion-select formControlName="offerValidity" placeholder="Select Validity">
            <ion-select-option value="2">2 Days</ion-select-option>
            <ion-select-option value="7">7 Days</ion-select-option>
          </ion-select>
        </ion-item>

        <ion-item>
          <ion-label>Date of Joining</ion-label>
          <ion-input type="date" formControlName="dateOfJoining"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label>Template</ion-label>
          <ion-select formControlName="template" placeholder="Select Template">
            <ion-select-option value="template1">Template 1</ion-select-option>
            <ion-select-option value="template2">Template 2</ion-select-option>
          </ion-select>
        </ion-item>

        <ion-button
          expand="block"
          color="primary"
          type="button"
          (click)="previewOfferLetter()"
          [disabled]="!canPreviewOffer()"
        >
          Preview Offer Letter
        </ion-button>
      </form>

      <div class="btn-group">
        <ion-button
          color="secondary"
          type="button"
          (click)="goToPolicy()"
          [disabled]="!canPreviewOffer()"
          style="margin-top: 10px;"
        >
          Next
        </ion-button>
        <ion-button color="medium" type="button" (click)="onCancel()">Cancel</ion-button>
      </div>
    </div>

    <!-- Policy Acknowledgment -->
    <div class="card" *ngIf="selectedCard === 'Policy'">
      <h2>Policy Acknowledgment</h2>
      <p>Please read and accept the policy documents.</p>

      <form [formGroup]="policyForm">
        <ion-item>
          <ion-label>Offer Status</ion-label>
          <ion-select formControlName="offerStatus" placeholder="Select Status">
            <ion-select-option value="hold">Hold</ion-select-option>
            <ion-select-option value="release">Release</ion-select-option>
          </ion-select>
        </ion-item>

        <ion-item lines="none">
          <ion-checkbox formControlName="policyAccepted" label-placement="end"></ion-checkbox>
          <ion-label>I accept the policies</ion-label>
        </ion-item>
      </form>

      <ion-button color="success" (click)="sendOfferStatus()">
        Send Offer
      </ion-button>
    </div>
  </form>

  <!-- Salary Modal -->
  <ion-modal [isOpen]="isSalaryModalOpen" (didDismiss)="closeSalaryModal()">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Salary Information</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeSalaryModal()">Close</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content class="ion-padding">
        <form [formGroup]="salaryForm" (ngSubmit)="saveSalary()">
          <ion-item>
            <ion-label position="floating">Gross Salary</ion-label>
            <ion-input type="number" formControlName="grossSalary"></ion-input>
          </ion-item>
          <ion-item>
            <ion-label position="floating">Basic Salary</ion-label>
            <ion-input type="number" formControlName="basicSalary"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">HRA</ion-label>
            <ion-input type="number" formControlName="hra"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">Health</ion-label>
            <ion-input type="number" formControlName="health"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">EPF Contribution (Employee)</ion-label>
            <ion-input type="number" formControlName="epfEmployee"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">EPF Contribution (Employer)</ion-label>
            <ion-input type="number" formControlName="epfEmployer" readonly></ion-input>
          </ion-item>

          <ion-button expand="block" type="submit">Save</ion-button>
        </form>
      </ion-content>
    </ng-template>
  </ion-modal>

  <!-- Offer Letter Preview Modal -->
  <ion-modal [isOpen]="isOfferPreviewOpen" (didDismiss)="isOfferPreviewOpen = false">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Offer Letter Preview</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="isOfferPreviewOpen = false">Close</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <div *ngIf="offerLetter">
          <!-- Your existing template switch logic for offerLetter -->
        </div>
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-content>
